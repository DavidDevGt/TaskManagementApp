<ion-header [translucent]="true">
  <ion-toolbar color="secondary">
    <ion-title>Tareas</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="openFilterModal()"><ion-icon slot="icon-only" name="filter-outline"></ion-icon></ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content [fullscreen]="true" #content>
    <ion-list *ngIf="(tasks$ | async)?.length; else emptyState">
        <ion-item-sliding *ngFor="let task of tasks$ | async; trackBy: trackByTask">

            <ion-item-options side="start">
                <ion-item-option 
                    [color]="task.completed ? 'warning' : 'success'" 
                    (click)="toggleComplete(task)">
                    <ion-icon slot="icon-only" [name]="task.completed ? 'arrow-undo-outline' : 'checkmark-done-circle-outline'"></ion-icon>
                    {{ task.completed ? 'Pendiente' : 'Completar' }} 
                </ion-item-option>
            </ion-item-options>
            
            <ion-item detail button (click)="viewTaskDetails(task)">
                
                <ion-icon
                    slot="start"
                    [name]="task.completed ? 'checkbox-outline' : 'square-outline'"
                    [color]="task.completed ? 'success' : 'medium'">
                </ion-icon>

                <ion-label [class.task-completed]="task.completed">
                    <h2>{{ task.title }}</h2>
                    <ion-badge [color]="task.completed ? 'success' : 'warning'">
                        {{ task.completed ? 'Completada' : 'Pendiente' }}
                    </ion-badge>
                    <p *ngIf="task.description" class="task-description">{{ task.description }}</p>
                </ion-label>
                
                <ion-label slot="end" class="ion-text-end ion-hide-sm-down" color="medium">
                    {{ task.typeName }}
                </ion-label>
            </ion-item>

            <ion-item-options side="end">
                <ion-item-option color="danger" (click)="deleteTask(task)">
                    <ion-icon slot="icon-only" name="trash"></ion-icon>
                </ion-item-option>
            </ion-item-options>
            
        </ion-item-sliding>

        </ion-list>

    <ng-template #emptyState>
        <div class="ion-padding ion-text-center">
            <ion-icon name="document-text-outline" size="large" color="medium"></ion-icon>
            <h3>No hay tareas aÃºn</h3>
            <p color="medium">Crea tu primera tarea en la pestaÃ±a "Nueva Tarea"</p>
        </div>
    </ng-template>
</ion-content>